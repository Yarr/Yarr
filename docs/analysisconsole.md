# AnalysisConsole

The AnalysisConsole is a program allowing access to the back-end of the
[*scanConsole*](scanconsole.md) program. This is particularly useful for
testing.

## Quick Start

The first step is to generate some input histograms, which can be done
by adding `HistogramArchiver` to the analysis section of the standard
scan config (and running `scanConsole` as normal). This will save the output
of the initial histogrammer stage to file, in addition to the normal analysis
histograms.

Next you can run as follows:

```bash
$ bin/analysis_test -c configs/defaults/default_star.json -y Star -s data/last_scan/std_nmask.json data/last_scan/JohnDoe_OccupancyMap_*.json
```

This takes the OccupancyMap histograms generated by the last scan to be
run (a Star nmask scan) and reprocesses them.

The output of the analysis can be found in the folder
`data/reanalysis/std_nmask`. In addition the file `config_post_analysis.json`
contains the front end configuration as modified by the analysis.

Note that if `HistogramArchiver` is in the scan config it will be ignored
to avoid regenerating duplicate files as output.

## Command Line Arguments

The required parameters are as in the quick start example above.

- **-c Front end configuration
- **-y Front end type
- **-s Scan configuration (identical to scanConsole)
- List of histogram files to be loaded

Note that the analysis is run for one front end at a time so there is no
need for the connectivity configuration file.

- **-h** : prints all available command line arguments
- **-t  ``<target_charge>`` [``<target_tot>``]** : Set target values for threshold (charge only) and tot (charge and tot).
- **-p** : Enable plotting of results (generate png files).
- **-o ``<dir>``** : Base output directory. (Default ./data/)
- **-m ``<int>``** : 0 = disable pixel masking, 1 = reset pixel masking, default = enable pixel masking
- **-l ``<path>``** => Logger config : this points to a json file to configure the [logging](logging.json) system. The default is to print info, warnings and errors to the console with appropriate colorization.
